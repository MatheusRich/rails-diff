# Rails::Diff

Compare your Rails application files with the ones generated by Rails main
branch. This helps you keep track of changes between your customized files and
the latest Rails templates.

## Installation

Add this line to your application's Gemfile:

```ruby
gem 'rails-diff'
```

And then execute:

```bash
$ bundle install
```

Or install it yourself as:

```bash
$ gem install rails-diff
```

## Usage

### Compare specific files

```bash
# Compare a single file
rails-diff file Dockerfile

# Compare multiple files
rails-diff file Dockerfile Gemfile

# Force regenerate Rails app by clearing cache
rails-diff file Dockerfile --clear-cache

# Fail if there are differences (useful for CI)
rails-diff file Dockerfile --fail-on-diff
```

### Compare generator files

```bash
# Compare files that would be created by a generator
rails-diff generated authentication

# Compare files with generator arguments
rails-diff generated scaffold Post title:string body:text

# Force regenerate Rails app by clearing cache
rails-diff generated scaffold Post --clear-cache

# Skip specific files or directories during the diff
rails-diff generated scaffold Post --skip app/views app/helpers

# Fail if there are differences (useful for CI)
rails-diff generated scaffold Post --fail-on-diff
```

### Options

#### --fail-on-diff

If this option is specified, the command will exit with a non-zero status code if there are any differences between your files and the generated ones. This can be particularly useful when using the gem in Continuous Integration (CI) environments.

## How it works

When you run the diff, it will:

1. Clone the latest Rails from main branch
1. Generate a new Rails app with the same name as yours
1. Show you a colored diff between your file and the generated one

### Cache

The gem caches the generated Rails application to avoid regenerating it on every run. The cache is automatically invalidated when:
- Rails has new commits on main
- The cache directory doesn't exist

You can also force clear the cache by using the `--no-cache` option (or its alias `--clear-cache`) with any command.

## Development

After checking out the repo, run `bin/setup` to install dependencies. Then, run `rake spec` to run the tests.

To install this gem onto your local machine, run `bundle exec rake install`.

## Contributing

Bug reports and pull requests are welcome on GitHub at https://github.com/matheusrich/rails-diff.

## License

The gem is available as open source under the terms of the [MIT License](https://opensource.org/licenses/MIT).
